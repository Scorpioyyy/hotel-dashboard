# 花园酒店评论分析项目需求文档

## 1. 项目概述

### 1.1 项目目标
开发一个基于 Next.js 的全栈 Web 应用，为广州花园酒店评论数据提供可视化分析看板和智能问答服务。

### 1.2 项目范围
- 数据管理与存储
- 评论浏览与筛选
- 数据可视化看板
- 智能问答服务

---

## 2. 数据说明

### 2.1 数据源文件

项目数据位于 `public` 文件夹，包含以下文件：

#### 2.1.1 enriched_comments.csv
广州花园酒店评论数据文件，包含以下字段：

| 字段名 | 数据类型 | 说明 |
|--------|---------|------|
| _id | String | 评论唯一标识 |
| comment | String | 文本评论内容 |
| images | Array | 评论配图 URL 地址列表 |
| score | Float | 酒店评分 |
| publish_date | String | 发布时间 |
| room_type | String | 房型 |
| fuzzy_room_type | String | 模糊房型 |
| travel_type | String | 出行类型 |
| comment_len | Integer | 评论文本长度 |
| log_comment_len | Float | 对数评论文本长度 |
| useful_count | Integer | 点赞数 |
| log_useful_count | Float | 对数点赞数 |
| review_count | Integer | 回复数 |
| log_review_count | Float | 对数回复数 |
| quality_score | Integer | 评论质量分(0-10) |
| categories | Array | 所属小类列表 |

**数据示例：**
```
_id: 68027895e3c98b0941765706
comment: "房间非常好 装修很厚重奢华..."
images: ["https://dimg04.c-ctrip.com/images/...", ...]
score: 5.0
publish_date: 2025-04-05
room_type: 红棉大床套房
fuzzy_room_type: 套房
travel_type: 家庭亲子
comment_len: 320
log_comment_len: 5.771441123130016
useful_count: 0
log_useful_count: 0.0
review_count: 7
log_review_count: 2.079441541679836
quality_score: 9
categories: ['房间设施', '前台服务', '餐饮设施']
```

#### 2.1.2 categories.json
评论分类指导文件，结构如下：
- **5个大类**
- **14个小类**（以小类为准）
- 小类后附有举例说明（可忽略）

---

## 3. 技术架构

### 3.1 前端技术栈
- **框架：** Next.js
- **要求：**
  - 界面美观简洁
  - 响应式设计
  - 强交互性

### 3.2 后端技术栈
- **数据库：** Insforge
- **调用方式：** MCP (已配置完成)
- **AI 模型：** Gemini 3 Flash Preview

### 3.3 系统架构
```
前端 (Next.js) 
    ↓
后端 API
    ↓
Insforge 数据库 ← 数据导入 (enriched_comments.csv)
    ↓
AI 问答服务 (Gemini 3 Flash Preview)
```

---

## 4. 功能需求

### 4.1 数据看板模块

#### 4.1.1 评论浏览
- 图文展示（comment + images）
- 按条件筛选展示
- 高质量评论推荐

#### 4.1.2 数据可视化
展示以下维度的数据图表（具体图表类型可根据数据特点选择）：

- 评分分布统计（score）
- 质量分布（quality_score）
- 时间趋势分析（publish_date）
- 评论类别分布（categories，基于 14 个小类）
- 房型分析（基于 fuzzy_room_type）
- 出行类型分布（travel_type）

#### 4.1.3 交互功能
- 图表筛选与联动
- 数据钻取
- 时间范围选择
- 分类筛选

### 4.2 智能问答模块

#### 4.2.1 问答流程
1. 用户输入问题
2. 后端基于关键词在 Insforge 数据库中检索相关评论
3. 召回相关评论数据
4. 使用 Gemini 3 Flash Preview 模型生成回答
5. 返回模型回答至前端展示
6. 额外展示召回得到的评论，即模型回复的依据，但需注意展示原始评论时也应保持整体页面美观整洁

#### 4.2.2 功能特性
- 自然语言问答
- 上下文理解
- 引用相关评论
- 回答质量保证

---

## 5. 数据处理要求

### 5.1 数据导入
- 将 `enriched_comments.csv` 完整导入 Insforge 数据库
- 保留所有字段
- 确保数据类型正确（特别是 Array 类型字段）

### 5.2 数据索引
- 为关键字段建立索引以优化查询性能
- 为全文检索建立索引（comment 字段）

---

## 6. 非功能性需求

### 6.1 性能要求
- 页面加载时间 < 3秒
- 图表渲染流畅
- 问答响应时间 < 5秒

### 6.2 用户体验
- 界面简洁直观
- 操作反馈及时
- 移动端友好
- 全部使用中文

### 6.3 可维护性
- 代码结构清晰
- 注释完整
- 模块化设计

---

## 7. 注意事项

1. 日期格式需正确解析
2. `images`, `categories` 字段为数组，需正确解析
3. 确保 AI 回答基于实际评论数据，避免幻觉